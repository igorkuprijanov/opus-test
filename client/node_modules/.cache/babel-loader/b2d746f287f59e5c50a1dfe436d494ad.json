{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Me\\\\Desktop\\\\opus\\\\client\\\\src\\\\components\\\\Main.tsx\";\nimport React from 'react';\nimport LogInPage from './LogInPage';\nimport InterfacePage from './InterfacePage';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Main extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.sendData = async (data, url, method) => {\n      const response = await fetch(`http://localhost:4000/${url}`, {\n        method: method,\n        mode: 'cors',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include',\n        body: JSON.stringify(data)\n      }).then(response => {\n        if (response.ok) {\n          return response.json().then(json => {\n            console.log(json);\n            return json;\n          });\n        } else if (!response.ok) {\n          console.log(Error(response.statusText));\n        }\n      });\n      return response;\n    };\n\n    this.sendLogin = async data => {\n      const response = await this.sendData(data, 'login', 'POST');\n      console.log(response);\n\n      if (response.status) {\n        this.setState({\n          isLoggedIn: true,\n          clientToken: response.accessToken,\n          user: response.data.email.toString(),\n          showMessage: false,\n          message: {\n            head: '',\n            body: ''\n          }\n        }, this.getAllUsers);\n        this.setState({\n          showMessage: true,\n          message: {\n            head: response.data.head,\n            body: response.data.body\n          }\n        });\n      }\n    };\n\n    this.sendCreateAccount = async data => {\n      if (data.password === data.repeatPassword) {\n        const response = await this.sendData(data, 'registration', 'POST');\n\n        if (response.status) {\n          if (this.state.openPopup) {\n            this.setState({\n              openPopup: false,\n              unsortedUsers: [...this.state.unsortedUsers, data.email],\n              sortedUsers: this.sortUsers([...this.state.unsortedUsers, data.email])\n            });\n          }\n\n          this.setState({\n            showMessage: true,\n            message: {\n              head: response.data.head,\n              body: response.data.body\n            }\n          });\n        } else if (!response.status) {\n          this.setState({\n            showMessage: true,\n            message: {\n              head: response.data.head,\n              body: response.data.body\n            }\n          });\n        }\n      } else {\n        this.setState({\n          showMessage: true,\n          message: {\n            head: 'Passwords dont match',\n            body: 'Check that both password fields are the same.'\n          }\n        });\n      }\n    };\n\n    this.deleteUser = async name => {\n      await this.sendData({\n        name\n      }, 'delete', 'DELETE').then(response => {\n        if (!response.status) {\n          alert('Could not delete user, please try again');\n        } else {\n          this.popup('delete');\n          let newUsers = this.state.unsortedUsers;\n          let userIndex = newUsers.indexOf(name);\n          newUsers.splice(userIndex, 1);\n          this.setState({\n            unsortedUsers: newUsers,\n            sortedUsers: this.sortUsers(newUsers)\n          });\n        }\n      });\n    };\n\n    this.getAllUsers = async () => {\n      try {\n        await fetch(`http://localhost:4000/users`, {\n          method: 'GET',\n          mode: 'cors',\n          headers: new Headers({\n            'Authorization': `Bearer ${this.state.clientToken}`,\n            'Content-Type': 'application/json'\n          })\n        }).then(response => {\n          if (response.ok) {\n            return response.json().then(json => {\n              this.setState({\n                unsortedUsers: json,\n                sortedUsers: this.sortUsers(json)\n              });\n            });\n          } else if (!response.ok) {\n            throw Error(response.statusText);\n          }\n        });\n      } catch (error) {\n        console.log(error);\n      }\n    };\n\n    this.sendResetPassword = async data => {\n      const response = await this.sendData(data, 'restore', 'POST');\n      this.setState({\n        showMessage: true,\n        message: {\n          head: response.message.head,\n          body: response.message.body\n        }\n      });\n    };\n\n    this.hideMessage = () => {\n      this.setState({\n        showMessage: false\n      });\n    };\n\n    this.sortUsers = data => {\n      let newUsers = [];\n      console.log(this.state.unsortedUsers);\n      console.log(newUsers);\n\n      for (let i = 0; i < data.length; i++) {\n        let sliceableArray = data.slice(i * 6, 6 * (i + 1));\n        if (sliceableArray.length > 0) newUsers.push(sliceableArray);\n      }\n\n      console.log(newUsers);\n      console.log(this.state.sortedUsers);\n      console.log(data);\n      return newUsers;\n    };\n\n    this.popup = type => {\n      if (type === 'add') {\n        this.setState({\n          openPopup: !this.state.openPopup,\n          addingUser: true\n        });\n      } else {\n        this.setState({\n          openPopup: !this.state.openPopup,\n          addingUser: false\n        });\n      }\n    };\n\n    this.state = {\n      isLoggedIn: false,\n      user: '',\n      showMessage: false,\n      message: {\n        body: '',\n        head: ''\n      },\n      openPopup: false,\n      addingUser: false,\n      unsortedUsers: [],\n      sortedUsers: [],\n      clientToken: ''\n    };\n    this.sendData = this.sendData.bind(this);\n    this.sendLogin = this.sendLogin.bind(this);\n    this.sendCreateAccount = this.sendCreateAccount.bind(this);\n    this.sendResetPassword = this.sendResetPassword.bind(this);\n  }\n\n  render() {\n    console.log(this.state);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: this.state.isLoggedIn ? /*#__PURE__*/_jsxDEV(InterfacePage, {\n        users: this.state.sortedUsers,\n        deleteUser: this.deleteUser,\n        addingUser: this.state.addingUser,\n        popup: this.popup,\n        openPopup: this.state.openPopup,\n        showMessage: this.state.showMessage,\n        sendCreateAccount: this.sendCreateAccount,\n        message: this.state.message,\n        name: this.state.user\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 34\n      }, this) : /*#__PURE__*/_jsxDEV(LogInPage, {\n        hideMessage: this.hideMessage,\n        showMessage: this.state.showMessage,\n        message: this.state.message,\n        sendLogin: this.sendLogin,\n        sendCreateAccount: this.sendCreateAccount,\n        sendResetPassword: this.sendResetPassword\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 332\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default Main;","map":{"version":3,"sources":["C:/Users/Me/Desktop/opus/client/src/components/Main.tsx"],"names":["React","LogInPage","InterfacePage","Main","Component","constructor","props","sendData","data","url","method","response","fetch","mode","headers","credentials","body","JSON","stringify","then","ok","json","console","log","Error","statusText","sendLogin","status","setState","isLoggedIn","clientToken","accessToken","user","email","toString","showMessage","message","head","getAllUsers","sendCreateAccount","password","repeatPassword","state","openPopup","unsortedUsers","sortedUsers","sortUsers","deleteUser","name","alert","popup","newUsers","userIndex","indexOf","splice","Headers","error","sendResetPassword","hideMessage","i","length","sliceableArray","slice","push","type","addingUser","bind","render"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport LogInPage from './LogInPage'\r\nimport InterfacePage from './InterfacePage'\r\n\r\nclass Main extends React.Component<{}, {clientToken: string, sortedUsers: Array<Array<string>>, unsortedUsers: Array<string>, isLoggedIn: boolean, addingUser: boolean, user:string, showMessage: boolean, message: {head: string, body: string}, openPopup: boolean}>{\r\n\r\n  constructor(props: any){\r\n    super(props)\r\n    this.state = {\r\n      isLoggedIn: false,\r\n      user: '',\r\n      showMessage: false,\r\n      message: {body: '', head: ''},\r\n      openPopup: false,\r\n      addingUser: false,\r\n      unsortedUsers: [],\r\n      sortedUsers: [],\r\n      clientToken: ''\r\n\r\n    }\r\n    this.sendData = this.sendData.bind(this)\r\n    this.sendLogin = this.sendLogin.bind(this)\r\n    this.sendCreateAccount = this.sendCreateAccount.bind(this)\r\n    this.sendResetPassword = this.sendResetPassword.bind(this)\r\n  }\r\n\r\n  sendData = async (data:any, url:string, method: string) => {\r\n          const response =  await fetch(`http://localhost:4000/${url}`,\r\n          {\r\n            method: method,\r\n            mode: 'cors',\r\n            headers:{'Content-Type' : 'application/json'},\r\n            credentials: 'include',\r\n            body: JSON.stringify(data)\r\n          })\r\n          .then(response => {\r\n            if(response.ok){\r\n                return response.json().then(json =>{\r\n                  console.log(json)\r\n                return json\r\n              })\r\n            }else if(!response.ok){\r\n              console.log(Error(response.statusText))\r\n            }\r\n          })\r\n          return response\r\n\r\n\r\n  }\r\n\r\n  sendLogin = async (data: {email: string, password: string}) =>{\r\n    const response = await this.sendData(data, 'login', 'POST')\r\n    console.log(response)\r\n    if(response.status){\r\n      this.setState({isLoggedIn: true,clientToken: response.accessToken, user: response.data.email.toString(), showMessage: false, message: {head: '', body: ''}}, this.getAllUsers)\r\n      this.setState({\r\n        showMessage: true,\r\n        message: {head: response.data.head, body: response.data.body}\r\n      })\r\n    }\r\n  }\r\n\r\n  sendCreateAccount = async (data: {email: string, password: string, repeatPassword: string}) =>{\r\n    if(data.password === data.repeatPassword){\r\n        const response = await this.sendData(data, 'registration', 'POST')\r\n        if(response.status){\r\n          if(this.state.openPopup){\r\n            this.setState({\r\n              openPopup: false,\r\n              unsortedUsers: [...this.state.unsortedUsers, data.email],\r\n              sortedUsers: this.sortUsers([...this.state.unsortedUsers, data.email])\r\n            })\r\n          }\r\n          this.setState({\r\n            showMessage: true,\r\n            message: {head: response.data.head, body:response.data.body}\r\n          })\r\n        }else if(!response.status){\r\n          this.setState({\r\n            showMessage: true,\r\n            message: {head: response.data.head, body:response.data.body}\r\n          })\r\n        }\r\n    }else{\r\n      this.setState({\r\n        showMessage: true,\r\n        message: {head: 'Passwords dont match', body: 'Check that both password fields are the same.'}\r\n      })\r\n    }\r\n  }\r\n\r\n  deleteUser = async (name: string) =>{\r\n    await this.sendData({name}, 'delete', 'DELETE')\r\n    .then(response => {if(!response.status){\r\n      alert('Could not delete user, please try again')\r\n    }else{\r\n      this.popup('delete')\r\n      let newUsers = this.state.unsortedUsers\r\n      let userIndex = newUsers.indexOf(name)\r\n      newUsers.splice(userIndex, 1)\r\n      this.setState({\r\n        unsortedUsers: newUsers,\r\n        sortedUsers: this.sortUsers(newUsers)\r\n      })\r\n\r\n    }})\r\n  }\r\n\r\n  getAllUsers = async() =>{\r\n    try{\r\n    await fetch(`http://localhost:4000/users`,\r\n    {\r\n      method: 'GET',\r\n      mode: 'cors',\r\n      headers: new Headers({\r\n        'Authorization': `Bearer ${this.state.clientToken}`,\r\n        'Content-Type' : 'application/json'\r\n      }),\r\n    })\r\n    .then(response => {\r\n      if(response.ok){\r\n          return response.json()\r\n          .then(json =>{\r\n          this.setState({\r\n            unsortedUsers: json,\r\n            sortedUsers: this.sortUsers(json)\r\n          })\r\n        })\r\n      }else if(!response.ok){\r\n        throw Error(response.statusText)\r\n      }\r\n    })\r\n  }catch (error){\r\n    console.log(error)\r\n  }\r\n  }\r\n\r\n\r\n  sendResetPassword = async(data: {email: string}) =>{\r\n    const response = await this.sendData(data, 'restore', 'POST')\r\n    this.setState({\r\n      showMessage: true,\r\n      message: {head: response.message.head, body:response.message.body}\r\n    })\r\n  }\r\n\r\n  hideMessage = () =>{\r\n    this.setState({\r\n      showMessage: false\r\n    })\r\n  }\r\n\r\n  sortUsers = (data: Array<string>) =>{\r\n    let newUsers: Array<Array<string>> = []\r\n    console.log(this.state.unsortedUsers)\r\n    console.log(newUsers)\r\n    for(let i =0; i<data.length; i++){\r\n      let sliceableArray = data.slice(i*6, 6*(i+1))\r\n      if(sliceableArray.length > 0)\r\n        newUsers.push(sliceableArray)\r\n      }\r\n    console.log(newUsers)\r\n    console.log(this.state.sortedUsers)\r\n    console.log(data)\r\n    return newUsers\r\n  }\r\n\r\n  popup = (type: string) =>{\r\n    if(type === 'add'){\r\n      this.setState({\r\n        openPopup: !this.state.openPopup,\r\n        addingUser: true\r\n      })\r\n    }else{\r\n      this.setState({\r\n        openPopup: !this.state.openPopup,\r\n        addingUser: false\r\n      })\r\n    }\r\n  }\r\n\r\n\r\n  render(){\r\n    console.log(this.state)\r\n    return (\r\n      <div className=\"App\">\r\n        {this.state.isLoggedIn ? <InterfacePage users={this.state.sortedUsers} deleteUser={this.deleteUser} addingUser={this.state.addingUser} popup={this.popup} openPopup={this.state.openPopup} showMessage={this.state.showMessage} sendCreateAccount={this.sendCreateAccount} message={this.state.message} name={this.state.user}/> : <LogInPage hideMessage={this.hideMessage} showMessage={this.state.showMessage} message={this.state.message} sendLogin={this.sendLogin} sendCreateAccount={this.sendCreateAccount} sendResetPassword={this.sendResetPassword}/>}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Main\r\n"]},"metadata":{},"sourceType":"module"}